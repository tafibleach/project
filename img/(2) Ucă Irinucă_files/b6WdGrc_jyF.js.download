if (self.CavalryLogger) { CavalryLogger.start_js(["AfHGA"]); }

__d("SubscribeStatuses",[],(function a(b,c,d,e,f,g){f.exports={CANNOT_SUBSCRIBE:"CANNOT_SUBSCRIBE",IS_SUBSCRIBED:"IS_SUBSCRIBED",CAN_SUBSCRIBE:"CAN_SUBSCRIBE"}}),null);
__d('FBStoriesActionTypes',[],(function a(b,c,d,e,f,g){var h={LOAD:'FB_STORIES.LOAD',LOADING:'FB_STORIES.LOADING',LOADED:'FB_STORIES.LOADED',LOADED_ERROR:'FB_STORIES.LOADED_ERROR',VIEWER_LIST_LOADED_FOR_THREAD:'FB_STORIES.VIEWER_LIST_LOADED_FOR_THREAD',RESET_LOCAL_SEEN_HISTORY:'FB_STORIES.RESET_LOCAL_SEEN_HISTORY',SELECTED_BUCKET_IDX_CHANGED:'FB_STORIES.SELECTED_BUCKET_IDX_CHANGED',SET_ALL_BUCKETS_VIEWED:'FB_STORIES.SET_ALL_BUCKETS_VIEWED',SET_UNSEEN_MODE:'FB_STORIES.SET_UNSEEN_MODE',SELECTED_THREAD_IDX_CHANGED:'FB_STORIES.SELECTED_THREAD_IDX_CHANGED',SELECTED_THREAD_PERCENT_DONE:'FB_STORIES.SELECTED_THREAD_PERCENT_DONE',SUBSCRIPTION_BUCKET_UPDATE:'FB_STORIES.SUBSCRIPTION_BUCKET_UPDATE',UPDATE_THREAD_SEEN_OPTIMISTIC:'FB_STORIES.UPDATE_THREAD_SEEN_OPTIMISTIC',UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:'FB_STORIES.UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC',DELETE_THREAD_FROM_BUCKET:'FB_STORIES.DELETE_THREAD_FROM_BUCKET',REMOVE_BUCKET:'FB_STORIES.REMOVE_BUCKET',SET_SATP_NATIVE_RENDER:'FB_STORIES.SET_SATP_NATIVE_RENDER',REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:'FB_STORIES.REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET'};f.exports=h}),null);
__d('FBStoriesDispatcher',['ExplicitRegistrationReactDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('ExplicitRegistrationReactDispatcher'));i=h&&h.prototype;function j(k){i.constructor.call(this,k);this.dispatch=this.dispatch.bind(this)}f.exports=new j({strict:true})}),null);
__d("FBStoriesBucketsQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1611756012198851"};j.getQueryID=function(){"use strict";return "214777885720931"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesDeleteMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1340045906066120"};j.getQueryID=function(){"use strict";return "967072946766012"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLMutationBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1386522808128715"};j.getQueryID=function(){"use strict";return "1384057201673076"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d("FBStoriesTraySubscriptionWebGraphQLSubscription",["WebGraphQLSubscriptionHelper"],(function a(b,c,d,e,f,g){'use strict';f.exports=c("WebGraphQLSubscriptionHelper").getExports({docID:"1432349293523842",queryID:"364869010598695"})}),null);
__d('FBStoriesTraySubscription',['BaseGraphQLSubscription','FBStoriesTraySubscriptionWebGraphQLSubscription','GraphQLSubscriptionsConfig','uuid'],(function a(b,c,d,e,f,g){var h=babelHelpers['extends']({},c('BaseGraphQLSubscription'),{_getTopic:function i(j){return 'gqls/stories_tray_subscribe/user_id_'+j},_getQueryID:function i(){return c('GraphQLSubscriptionsConfig').shouldUseGraphQL2DocumentIDs?c('FBStoriesTraySubscriptionWebGraphQLSubscription').getDocID():c('FBStoriesTraySubscriptionWebGraphQLSubscription').getLegacyQueryID()},_getQueryParameters:function i(j){return {input:JSON.stringify({client_subscription_id:c('uuid')(),user_id:j})}},_getSubscriptionCallName:function i(){return 'stories_tray_subscribe'}});f.exports=h}),null);
__d("FBStoriesViewerBucketViewersQueryWebGraphQLQuery",["WebGraphQLQueryBase"],(function a(b,c,d,e,f,g){'use strict';f.exports=function(){var h,i;h=babelHelpers.inherits(j,c("WebGraphQLQueryBase"));i=h&&h.prototype;j.__getDocID=function(){"use strict";return "1641309632559607"};j.getQueryID=function(){"use strict";return "259112971249828"};function j(){"use strict";h.apply(this,arguments)}return j}()}),null);
__d('FBStoriesGraphQLAPI',['WebGraphQL','FBStoriesBucketsQueryWebGraphQLQuery','FBStoriesViewerBucketViewersQueryWebGraphQLQuery','FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation','FBStoriesTraySubscription','FBStoriesDeleteMutationWebGraphQLMutation','CurrentUser','uniqueID'],(function a(b,c,d,e,f,g){'use strict';f.exports={load:function h(){return c('WebGraphQL').exec(new (c('FBStoriesBucketsQueryWebGraphQLQuery'))())},loadViewerListForThread:function h(i){return c('WebGraphQL').exec(new (c('FBStoriesViewerBucketViewersQueryWebGraphQLQuery'))({threadId:i}))},subscribeToTrayChanges:function h(i){c('FBStoriesTraySubscription').subscribe(c('CurrentUser').getID(),i)},updateThreadSeenReciept:function h(i){var j={client_mutation_id:c('uniqueID')(),actor_id:c('CurrentUser').getID(),thread_id:i};return c('WebGraphQL').exec(new (c('FBStoriesSeenRecieptsLastSeenTimeUpdateMutationWebGraphQLMutation'))({input:j}))},deleteStory:function h(i,j){return c('WebGraphQL').exec(new (c('FBStoriesDeleteMutationWebGraphQLMutation'))({input:{client_mutation_id:c('uniqueID')(),actor_id:i,story_thread_ids:[j]}}))}}}),null);
__d("BackstageMediaType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({LIVE:"live",PHOTO:"photo",VIDEO:"video",UNKNOWN:"unknown"})}),null);
__d("CameraPostTypes",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({DIRECT:"DIRECT",GROUP_DIRECT:"GROUP_DIRECT",DIRECT_NUX:"DIRECT_NUX",STORY:"STORY",STORY_NUX:"STORY_NUX",PAGE_STORY:"PAGE_STORY",EVENT_STORY:"EVENT_STORY",LIVE_STORY:"LIVE_STORY",PROMOTION_STORY:"PROMOTION_STORY"})}),null);
__d('FBStoriesLoggingConstants',[],(function a(b,c,d,e,f,g){'use strict';var h={EVENT_STORY:'eventStory',FOLLOWEE_STORY:'followeeStory',FRIEND_STORY:'friendStory',LIVE_STORY:'liveStory',MISSING_STORY_DATA:'missingStoryData',PAGE_STORY:'pageStory',SELF_STORY:'selfStory',STORY_PROMOTION:'storyPromotion'};f.exports=h}),null);
__d('FBStoriesDataHelper',['idx','CurrentUser','CameraPostTypes','FBStoriesLoggingConstants'],(function a(b,c,d,e,f,g){'use strict';var h={getUnseenThread:function j(k){var l=i.getThreadsForBucket(k);return l[Math.max(0,i.getUnseenThreadIndex(k))]}},i={isUserBucket:function j(k){var l;return ((l=k)!=null?(l=l.camera_post_bucket_owner)!=null?l.id:l:l)===c('CurrentUser').getID()},isBucketLive:function j(k){var l;return !!((l=k)!=null?(l=l.live_video)!=null?l.id:l:l)},hasDataInBucket:function j(k){if(!k)return false;return i.getThreadsForBucket(k).length>0},getThreadsForBucket:function j(k){var l,m=((l=k)!=null?(l=l.threads)!=null?l.nodes:l:l)||[];return m.filter(function(n){var o;return ((o=n)!=null?o.thread_status:o)==='PUBLISHED'})},getUnseenThreadIndex:function j(k){var l=i.getThreadsForBucket(k),m=i.isUserBucket(k);return m?l.findIndex(function(n){return n.seen_receipts_unseen_count>0}):l.findIndex(function(n){return !n.is_seen_by_viewer})},getPreviewImage:function j(k){var l,m=h.getUnseenThread(k);return (l=m)!=null?(l=l.root_message)!=null?(l=l.message_media)!=null?l.preview_image:l:l:l},getFriendsBucketDataFromLoadedObject:function j(k){var l;return ((l=k)!=null?(l=l.me)!=null?(l=l.friends_stories_buckets)!=null?l.nodes:l:l:l)||[]},getBucketOwnerType:function j(k){if(!k)return c('FBStoriesLoggingConstants').MISSING_STORY_DATA;if(this.isUserBucket(k))return c('FBStoriesLoggingConstants').SELF_STORY;if(this.isBucketLive(k))return c('FBStoriesLoggingConstants').LIVE_STORY;if(k.camera_post_type===c('CameraPostTypes').PAGE_STORY)return c('FBStoriesLoggingConstants').PAGE_STORY;if(k.camera_post_type===c('CameraPostTypes').EVENT_STORY)return c('FBStoriesLoggingConstants').EVENT_STORY;if(k.camera_post_type===c('CameraPostTypes').PROMOTION_STORY)return c('FBStoriesLoggingConstants').STORY_PROMOTION;if(!k.camera_post_bucket_owner.is_viewer_friend)return c('FBStoriesLoggingConstants').FOLLOWEE_STORY;return c('FBStoriesLoggingConstants').FRIEND_STORY},getFriendsDataWithEndedLiveBucket:function j(k,l){if(!l||!i.isBucketLive(l))return k;var m=l.id,n=false;k=k.reduce(function(o,p){if(p.id===m){n=true;var q=!i.isBucketLive(p);if(l&&q){p.live_video=l.live_video;p.has_live_video_ended=true}}o.push(p);return o},[]);if(!n){l.has_live_video_ended=true;k=[l].concat(k)}return k}};f.exports=i}),null);
__d('FBStoriesLiveVideoActionTypes',['keyMirror'],(function a(b,c,d,e,f,g){var h=c('keyMirror')({SET_UI_COMPONENTS:null,REMOVE_UI_COMPONENTS:null,LIVE_BUCKET_LOADED:null});f.exports=h}),null);
__d('friendsBucketSorter',['CameraPostTypes','idx'],(function a(b,c,d,e,f,g){'use strict';function h(q){return function r(s,t){var u=s.live_video&&s.live_video.id,v=t.live_video&&t.live_video.id;if(u!==v)return u?-1:1;if(i(s,t))return k(s)?-1:1;if(j(s,t))return l(s)?-1:1;if(m(s,t,q))return n(s,q)?-1:1;return p(s)>=p(t)?-1:1}}function i(q,r){return o(q,r,k)}function j(q,r){return o(q,r,l)}function k(q){return q.unseen_count>0}function l(q){return q.camera_post_type===c('CameraPostTypes').EVENT_STORY}function m(q,r,s){return n(q,s)!==n(r,s)}function n(q,r){var s,t=((s=q)!=null?(s=s.threads)!=null?s.nodes:s:s)||[];for(var u=0;u<t.length;u++){var v,w=(v=t[u])!=null?(v=v.thread_owner)!=null?v.id:v:v;if(w===r)return true;}return false}function o(q,r,s){var t=s(q),u=s(r);return t!=u}function p(q){return q.ranking.score}f.exports=h}),null);
__d('FBStoriesStore',['BackstageMediaType','Bootloader','CameraPostTypes','FBStoriesActionTypes','FBStoriesDispatcher','FBStoriesDataHelper','FBStoriesLiveVideoActionTypes','FluxReduceStore','LoadObject','SubscribeStatuses','idx','Map','friendsBucketSorter'],(function a(b,c,d,e,f,g){'use strict';var h,i;h=babelHelpers.inherits(j,c('FluxReduceStore'));i=h&&h.prototype;j.prototype.getInitialState=function(){return {data:c('LoadObject').empty(),selectedBucketIndex:-1,currentThreadIndex:-1,currentThreadPercentDone:0,unseenMode:false,allBucketsViewed:false,lastViewedThreadIndexForBucket:new (c('Map'))(),showSATPNativeRender:false}};j.prototype.reduce=function(k,l){var m,n=this,o,p,q,r,s,t,u,v,w;switch(l.type){case c('FBStoriesActionTypes').LOADING:return babelHelpers['extends']({},k,{data:c('LoadObject').loading()});case c('FBStoriesActionTypes').LOADED:var x=l.data,y=c('FBStoriesDataHelper').getFriendsBucketDataFromLoadedObject(x);y=y.reduce(function(oa,pa){var qa,ra=this.$FBStoriesStore1(pa),sa=ra&&ra.length>0,ta=pa.camera_post_type===c('CameraPostTypes').STORY_NUX,ua=pa.camera_post_type===c('CameraPostTypes').EVENT_STORY,va=((qa=pa)!=null?(qa=qa.camera_post_bucket_owner)!=null?qa.subscribe_status:qa:qa)===c('SubscribeStatuses').IS_SUBSCRIBED;if(ta)return oa;if(!sa){if(this.$FBStoriesStore2(pa))return oa.concat([pa]);return oa}if(va||ua)return oa.concat([pa]);return oa}.bind(this),[]);var z=((s=x)!=null?(s=s.me)!=null?(s=s.story_bucket)!=null?s.nodes:s:s:s)||[],aa=z[0],ba={userName:(t=x)!=null?(t=t.me)!=null?t.name:t:t,userID:(u=x)!=null?(u=u.me)!=null?u.id:u:u,userGender:(v=x)!=null?(v=v.me)!=null?v.gender:v:v,userProfilePic:(w=x)!=null?(w=w.me)!=null?w.profile_picture:w:w};y.sort(c('friendsBucketSorter')(ba.userID));c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(oa){oa.logStoryTrayLoad(aa,y)},'FBStoriesStore');y=c('FBStoriesDataHelper').getFriendsDataWithEndedLiveBucket(y,this.$FBStoriesStore3());return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userInfo:ba,userBucketData:aa,friendsBucketData:y})});case c('FBStoriesActionTypes').VIEWER_LIST_LOADED_FOR_THREAD:{var m=function(){var oa=l.data.node,pa=babelHelpers['extends']({},n.getUserBucketData(),{threads:{nodes:n.$FBStoriesStore4().map(function(qa){if(qa.id===l.threadID){return babelHelpers['extends']({},qa,{story_viewers:oa.story_viewers,friends_seen_count:oa.friends_seen_count,followers_seen_count:oa.followers_seen_count})}else return qa;})}});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:pa,userInfo:n.getUserInfo(),friendsBucketData:n.getFriendsBucketData()})})}}();if(typeof m==="object")return m.v;}case c('FBStoriesActionTypes').SUBSCRIPTION_BUCKET_UPDATE:{var o=function(){var oa=l.bucketData,pa=n.$FBStoriesStore1(oa),qa=pa.length>0||n.$FBStoriesStore2(oa),ra=oa.id,sa=n.getFriendsBucketData(),ta=false,ua=sa.reduce(function(va,wa){if(wa.id===ra){ta=true;if(qa)va.push(oa);}else va.push(wa);return va},[]);if(!ta&&qa)ua=[oa].concat(sa);ua=c('FBStoriesDataHelper').getFriendsDataWithEndedLiveBucket(ua,n.$FBStoriesStore3());ua.sort(c('friendsBucketSorter')(n.getUserInfo().userID));return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),userInfo:n.getUserInfo(),friendsBucketData:ua})})}}();if(typeof o==="object")return o.v;}case c('FBStoriesActionTypes').LOADED_ERROR:return babelHelpers['extends']({},k,{data:c('LoadObject').withError(new Error(l.error.errorSummary))});case c('FBStoriesActionTypes').RESET_LOCAL_SEEN_HISTORY:return babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:new (c('Map'))()});case c('FBStoriesActionTypes').SELECTED_BUCKET_IDX_CHANGED:{var ca=l.bucketIndex;return ca<0||ca>=this.getBucketCount()?k:babelHelpers['extends']({},k,{selectedBucketIndex:ca})}case c('FBStoriesActionTypes').SELECTED_THREAD_IDX_CHANGED:var da=this.getThreadCountForSelectedBucket();if(!this.isSelectedBucketLive()&&(l.index<0||l.index>=da))return k;var ea=new (c('Map'))(k.lastViewedThreadIndexForBucket);ea.set(this.getSelectedBucketIndex(),l.index);return babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:ea,currentThreadIndex:l.index});case c('FBStoriesActionTypes').SELECTED_THREAD_PERCENT_DONE:var fa=Math.min(100,Math.max(l.percentDone,0));return babelHelpers['extends']({},k,{currentThreadPercentDone:fa});case c('FBStoriesActionTypes').SET_ALL_BUCKETS_VIEWED:var ga=l.value;if(ga===k.allBucketsViewed)return k;return babelHelpers['extends']({},k,{allBucketsViewed:ga,unseenMode:k.unseenMode&&ga?false:k.unseenMode});case c('FBStoriesActionTypes').SET_UNSEEN_MODE:return babelHelpers['extends']({},k,{unseenMode:l.value});case c('FBStoriesActionTypes').UPDATE_THREAD_SEEN_OPTIMISTIC:var ha=this.getSelectedBucketId(),ia=this.getFriendsBucketData().map(function(oa){var pa,qa=this;if(oa.id===ha){var pa=function(){var ra=oa.unseen_count,sa=qa.$FBStoriesStore1(oa).map(function(ta){if(ta.id===l.threadID){if(!ta.is_seen_by_viewer)ra=Math.max(ra-1,0);return babelHelpers['extends']({},ta,{is_seen_by_viewer:true})}else return ta;});return {v:babelHelpers['extends']({},oa,{unseen_count:ra,threads:{nodes:sa}})}}();if(typeof pa==="object")return pa.v;}else return oa;}.bind(this));return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:ia})});case c('FBStoriesActionTypes').UPDATE_THREAD_VIEWERS_SEEN_OPTIMISTIC:{var ja=babelHelpers['extends']({},this.getUserBucketData(),{threads:{nodes:this.$FBStoriesStore4().map(function(oa){if(oa.id===l.threadID){return babelHelpers['extends']({},oa,{seen_receipts_unseen_count:0,seen_receipts_last_seen_time:Date.now()})}else return oa;})}});return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:ja,userInfo:this.getUserInfo(),friendsBucketData:this.getFriendsBucketData()})})}case c('FBStoriesActionTypes').DELETE_THREAD_FROM_BUCKET:{var p=function(){var oa=l.threadID,pa=l.bucketID;if(!n.isUserManagedThread(oa,pa))return {v:k};var qa=n.getUserBucketData(),ra=null;if(pa===qa.id){qa.threads.nodes=n.$FBStoriesStore1(qa).filter(function(ta){return ta.id!==oa});ra=n.getFriendsBucketData()}else ra=n.getFriendsBucketData().map(function(ta){if(ta.id===pa){var ua=this.$FBStoriesStore1(ta).filter(function(va){return va.id!==oa});return babelHelpers['extends']({},ta,{threads:{nodes:ua}})}else return ta;}.bind(n)).filter(function(ta){return this.$FBStoriesStore1(ta).length>0}.bind(n));var sa=k.lastViewedThreadIndexForBucket;if(oa===n.getCurrentThreadIDForSelectedBucket()){sa=new (c('Map'))(sa);sa.set(n.getSelectedBucketIndex(),undefined)}return {v:babelHelpers['extends']({},k,{lastViewedThreadIndexForBucket:sa,data:c('LoadObject').withValue({userBucketData:qa,friendsBucketData:ra,userInfo:n.getUserInfo()})})}}();if(typeof p==="object")return p.v;}case c('FBStoriesActionTypes').REMOVE_BUCKET:{var q=function(){var oa=l.bucketID,pa=n.getFriendsBucketData().filter(function(qa){return qa.id!==oa});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),friendsBucketData:pa,userInfo:n.getUserInfo()})})}}();if(typeof q==="object")return q.v;}case c('FBStoriesActionTypes').SET_SATP_NATIVE_RENDER:return babelHelpers['extends']({},k,{showSATPNativeRender:l.value});case c('FBStoriesLiveVideoActionTypes').LIVE_BUCKET_LOADED:{var ka=l.data,la=c('FBStoriesDataHelper').getFriendsBucketDataFromLoadedObject(ka),ma=[].concat(this.getFriendsBucketData()),na=la.reduce(function(oa,pa){if(this.$FBStoriesStore2(pa)&&this.getBucketIndexByBucketId(pa.id)===-1)oa.push(pa);return oa}.bind(this),ma);return babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:this.getUserBucketData(),userInfo:this.getUserInfo(),friendsBucketData:na})})}case c('FBStoriesActionTypes').REMOVE_ENDED_LIVE_VIDEO_FROM_BUCKET:{var r=function(){var oa=l.bucketID,pa=n.getFriendsBucketData().map(function(qa){if(qa.id===oa){qa.live_video=null;qa.has_live_video_ended=false}return qa});return {v:babelHelpers['extends']({},k,{data:c('LoadObject').withValue({userBucketData:n.getUserBucketData(),friendsBucketData:pa,userInfo:n.getUserInfo()})})}}();if(typeof r==="object")return r.v;}default:return k;}};j.prototype.$FBStoriesStore5=function(){var k=this.getState().data;return k.hasValue()?k.getValueEnforcing():{friendsBucketData:[],userBucketData:{},userInfo:{}}};j.prototype.getUserBucketData=function(){return this.$FBStoriesStore5().userBucketData||{}};j.prototype.getUserInfo=function(){return this.$FBStoriesStore5().userInfo||{}};j.prototype.getFriendsBucketData=function(){return this.$FBStoriesStore5().friendsBucketData||[]};j.prototype.isLoading=function(){return this.getState().data.isLoading()};j.prototype.getBucketIds=function(){var k=this.getFriendsBucketData().map(function(m){return m.id}),l=this.getUserBucketData().id;return [l].concat(k)};j.prototype.getSelectedBucketIndex=function(){return this.getState().selectedBucketIndex};j.prototype.getSelectedBucketId=function(){return this.getBucketIds()[this.getSelectedBucketIndex()]};j.prototype.areAllBucketsViewed=function(){return this.getState().allBucketsViewed};j.prototype.getCameraPostTypeForBucketId=function(k){var l;return ((l=this.$FBStoriesStore6(k))!=null?l.camera_post_type:l)||null};j.prototype.doesBucketContainThreadId=function(k,l){var m,n=this.$FBStoriesStore6(k),o=((m=n)!=null?(m=m.threads)!=null?m.nodes:m:m)||[];return o.find(function(p){return p.id===l})!==undefined};j.prototype.$FBStoriesStore6=function(k){return this.$FBStoriesStore7(this.getBucketIndexByBucketId(k))};j.prototype.getBucketIndexByBucketId=function(k){return this.getBucketIds().indexOf(k)};j.prototype.getSelectedBucketCameraPostType=function(){var k;return ((k=this.$FBStoriesStore3())!=null?k.camera_post_type:k)||null};j.prototype.getSelectedBucketOwner=function(){var k;return ((k=this.$FBStoriesStore3())!=null?k.camera_post_bucket_owner:k)||{}};j.prototype.getSelectedBucketOwnerID=function(){var k;return ((k=this.$FBStoriesStore3())!=null?(k=k.camera_post_bucket_owner)!=null?k.id:k:k)||null};j.prototype.getSelectedBucketUnseenCount=function(){var k;return ((k=this.$FBStoriesStore3())!=null?k.unseen_count:k)||0};j.prototype.getThreadsForSelectedBucket=function(){return this.$FBStoriesStore1(this.$FBStoriesStore3())};j.prototype.getCurrentThreadIndexForSelectedBucket=function(){return this.getState().currentThreadIndex};j.prototype.getCurrentThreadIDForSelectedBucket=function(){var k=this.getCurrentThreadForSelectedBucket();return k?k.id:null};j.prototype.getCurrentThreadCameraPostTypeForSelectedBucket=function(){if(this.isSelectedBucketLive())return c('CameraPostTypes').STORY;var k=this.getCurrentThreadForSelectedBucket();return k?k.camera_post_type:null};j.prototype.getCurrentThreadMediaTypeForSelectedBucket=function(){if(this.isSelectedBucketLive())return c('BackstageMediaType').LIVE;var k=this.getCurrentThreadForSelectedBucket();return k?k.root_message.message_media.__typename:null};j.prototype.getCurrentThreadMediaIDForSelectedBucket=function(){if(this.isSelectedBucketLive()){var k=this.getThreadDataForLive();return k&&k.media.id}var l=this.getCurrentThreadForSelectedBucket();return l?l.root_message.message_media.id:null};j.prototype.getCurrentThreadMediaViewerCountForSelectedBucket=function(){var k=this.getCurrentThreadForSelectedBucket();return k?k.friends_seen_count+k.followers_seen_count:null};j.prototype.getCurrentThreadForSelectedBucket=function(){return this.getThreadsForSelectedBucket()[this.getCurrentThreadIndexForSelectedBucket()]};j.prototype.getCurrentThreadData=function(){if(this.isSelectedBucketLive())return this.getThreadDataForLive();return this.$FBStoriesStore8(this.getState().currentThreadIndex)};j.prototype.shouldDisableReply=function(){var k,l,m=this.isOwnThread(),n=((k=this.$FBStoriesStore3())!=null?(k=k.camera_post_bucket_owner)!=null?k.is_viewer_friend:k:k)||false,o=((l=this.getCurrentThreadForSelectedBucket())!=null?(l=l.thread_owner)!=null?l.is_viewer_friend:l:l)||false;return m||!n&&!o||this.isSelectedBucketLive()};j.prototype.getFollowersSeenCount=function(){var k=this.getCurrentThreadForSelectedBucket();return k?k.followers_seen_count:0};j.prototype.getFriendsSeenCount=function(){var k=this.getCurrentThreadForSelectedBucket();return k?k.friends_seen_count:0};j.prototype.isOwnBucket=function(k){return (k!=undefined?k:this.getSelectedBucketId())===this.getUserBucketData().id};j.prototype.isOwnThread=function(){var k;if(this.isOwnBucket())return true;var l=this.getCurrentThreadForSelectedBucket(),m=(k=l)!=null?(k=k.thread_owner)!=null?k.id:k:k;return m===this.getUserInfo().userID};j.prototype.isBucketViewerEventHost=function(){var k,l=this.$FBStoriesStore3();return ((k=l)!=null?(k=k.camera_post_bucket_owner)!=null?k.is_viewer_host:k:k)||false};j.prototype.isUserManagedThread=function(k,l){var m,n,o=this.$FBStoriesStore6(l);if(!o)return false;var p=this.$FBStoriesStore9(k,o),q=(m=p)!=null?(m=m.thread_owner)!=null?m.id:m:m;return p&&(q===this.getUserInfo().userID||o.id===this.getUserBucketData().id||((n=o)!=null?(n=n.camera_post_bucket_owner)!=null?n.is_viewer_host:n:n))||false};j.prototype.getBucketCount=function(){return this.getFriendsBucketData().length+1};j.prototype.hasDataInSelectedBucket=function(){return c('FBStoriesDataHelper').hasDataInBucket(this.$FBStoriesStore3())};j.prototype.hasOwnBucketViewers=function(){var k=this.$FBStoriesStore4(),l=k.filter(function(m){return m.seen_receipts_unseen_count>0});return l.length>0};j.prototype.hasOwnBucketContent=function(){return this.$FBStoriesStore4().length>0||this.userBucketIsLive()};j.prototype.getThreadCountForSelectedBucket=function(){return this.getThreadsForSelectedBucket().length};j.prototype.userBucketIsLive=function(){return this.$FBStoriesStore2(this.getUserBucketData())};j.prototype.isSelectedBucketLive=function(){return this.$FBStoriesStore2(this.$FBStoriesStore3())};j.prototype.getSelectedBucketOwnerType=function(){return c('FBStoriesDataHelper').getBucketOwnerType(this.$FBStoriesStore3())};j.prototype.$FBStoriesStore2=function(k){return c('FBStoriesDataHelper').isBucketLive(k)};j.prototype.getCurrentThreadViewers=function(){var k;if(!this.isOwnThread())return [];var l=this.getCurrentThreadForSelectedBucket(),m=((k=l)!=null?(k=k.story_viewers)!=null?k.edges:k:k)||[],n=this.getUserInfo().userID;return m.reduce(function(o,p){var q,r,s=(q=p)!=null?(q=q.node)!=null?q.id:q:q,t=(r=p)!=null?r.seen_time:r;if(s!==n)o.push(babelHelpers['extends']({},p.node,{seenTime:t,isNewViewer:t>=l.seen_receipts_last_seen_time}));return o},[])};j.prototype.isUnseenMode=function(){return this.getState().unseenMode};j.prototype.getCurrentThreadPercentDone=function(){return this.getState().currentThreadPercentDone};j.prototype.getThreadCount=function(k){var l=this.$FBStoriesStore7(k);if(this.$FBStoriesStore2(l))return 0;if(k===0){var m=this.$FBStoriesStore1(this.getUserBucketData());return m.length}if(k>0){var n=this.$FBStoriesStore1(l);return n.length}return -1};j.prototype.getUnseenThreadIndex=function(k){return c('FBStoriesDataHelper').getUnseenThreadIndex(this.$FBStoriesStore7(k))};j.prototype.getAllowedNavigationType=function(){var k=this.getSelectedBucketIndex(),l=k===0||k==1&&!c('FBStoriesDataHelper').hasDataInBucket(this.getUserBucketData()),m=k===this.getBucketCount()-1,n=l&&this.getCurrentThreadIndexForSelectedBucket()==0,o=m&&this.getCurrentThreadIndexForSelectedBucket()===this.getThreadsForSelectedBucket().length-1;if(n)return 'NEXT_ONLY';if(o)return 'PREV_ONLY';return 'BOTH'};j.prototype.getLastSeenThreadIndexForBucket=function(k){var l=this.getState().lastViewedThreadIndexForBucket,m=l.get(k);return m==undefined?0:m};j.prototype.$FBStoriesStore4=function(){return this.$FBStoriesStore1(this.getUserBucketData())};j.prototype.$FBStoriesStore3=function(){return this.$FBStoriesStore7(this.getSelectedBucketIndex())};j.prototype.$FBStoriesStore7=function(k){var l;return k===0?this.getUserBucketData():(l=this.getFriendsBucketData())!=null?l[k-1]:l};j.prototype.$FBStoriesStore9=function(k,l){var m=this.$FBStoriesStore1(l),n=m.filter(function(o){return o.id===k});return n.length>0?n[0]:null};j.prototype.$FBStoriesStore1=function(k){return c('FBStoriesDataHelper').getThreadsForBucket(k)};j.prototype.$FBStoriesStore8=function(k){var l,m,n,o,p,q,r,s,t,u,v=this.getSelectedBucketOwner(),w=this.getThreadsForSelectedBucket()[k];if(!w)return null;var x=((l=w)!=null?(l=l.root_message)!=null?l.message_media:l:l)||{},y=((m=w)!=null?(m=m.root_message)!=null?m.www_text_format_metadata:m:m)||null,z=((n=w)!=null?(n=n.root_message)!=null?n.message_text:n:n)||'';return {media:x,bucketOwner:v,threadOwner:(o=w)!=null?o.thread_owner:o,participants:[],isSeen:(p=w)!=null?p.is_seen_by_viewer:p,latestMessageID:(q=w)!=null?(q=q.latest_message)!=null?q.id:q:q,time:((r=w)!=null?r.time:r)||0,threadID:((s=w)!=null?s.id:s)||'',cameraPostType:((t=w)!=null?t.camera_post_type:t)||'',cameraPostSource:((u=w)!=null?u.post_source:u)||'',wwwTextFormatMetadata:y,messageText:z}};j.prototype.getThreadDataForLive=function(){var k,l=this.$FBStoriesStore3();if(!l)return null;if(!this.$FBStoriesStore2(l))return null;var m=this.getSelectedBucketOwner();return {media:l.live_video,bucketOwner:m,isSeen:false,cameraPostType:((k=l)!=null?k.camera_post_type:k)||''}};j.prototype.isSelectedBucketLiveAndEnded=function(){var k;return this.isSelectedBucketLive()&&!!((k=this.$FBStoriesStore3())!=null?k.has_live_video_ended:k)};j.prototype.getSATPNativeRender=function(){return this.getState().showSATPNativeRender};function j(){h.apply(this,arguments)}f.exports=new j(c('FBStoriesDispatcher'))}),null);
__d('FBStoriesAppController',['FBStoriesGraphQLAPI','FBStoriesDispatcher','FBStoriesActionTypes','idx','Visibility','FBStoriesStore'],(function a(b,c,d,e,f,g){'use strict';var h=c('FBStoriesDispatcher').dispatch;f.exports={init:function i(j){c('FBStoriesDispatcher').explicitlyRegisterStores([c('FBStoriesStore')]);h({type:c('FBStoriesActionTypes').LOADING});var k=j.preloader;k.onLoaded(function(l){var m=l.result;return h({type:c('FBStoriesActionTypes').LOADED,data:m.data})});k.onError(function(l){return h({type:c('FBStoriesActionTypes').LOADED_ERROR,error:l})});c('FBStoriesGraphQLAPI').subscribeToTrayChanges(function(l){var m;h({type:c('FBStoriesActionTypes').SUBSCRIPTION_BUCKET_UPDATE,bucketData:(m=l)!=null?(m=m.stories_tray_subscribe)!=null?m.bucket:m:m})});c('Visibility').addListener(c('Visibility').VISIBLE,function(){c('FBStoriesGraphQLAPI').load().done(function(l){return h({type:c('FBStoriesActionTypes').LOADED,data:l})},function(l){return h({type:c('FBStoriesActionTypes').LOADED_ERROR,error:l})})});h({type:c('FBStoriesActionTypes').SET_SATP_NATIVE_RENDER,value:j.showSATPNativeRender})}}}),null);
__d('FBStoryTrayItem.react',['ix','cx','fbt','CameraPostTypes','Image.react','Tooltip.react','React','fbglyph','emptyFunction','IntlVariations','XUISpinner.react'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;k=babelHelpers.inherits(m,c('React').Component);l=k&&k.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return o=(n=l.constructor).call.apply(n,[this].concat(q)),this.$FBStoryTrayItem1=function(){if(this.props.onHover)this.props.onHover(this.props.bucketID);}.bind(this),this.$FBStoryTrayItem2=function(){if(this.props.onHoverOut)this.props.onHoverOut(this.props.bucketID);}.bind(this),this.$FBStoryTrayItem3=function(){if(!this.props.disabled&&!this.props.loading)this.props.onSelect(this.props.bucketID);}.bind(this),o}m.prototype.render=function(){if(!this.props.bucketID)return null;var n=this.props.cameraPostType===c('CameraPostTypes').EVENT_STORY,o=this.props.isBucketLive,p=!!this.props.imageUrl,q=!n&&!o,r="_1fw9"+(this.props.highlighted?' '+"_1fw0":'')+(o?' '+"_erm":'')+(p?' '+"_1fwa":''),s=p?c('React').createElement(c('Image.react'),{src:this.props.imageUrl,className:"_1fwb"}):c('React').createElement(c('Image.react'),{className:"_1fwb"+(' '+"_144-")}),t=q&&this.props.secondaryImageUrl?c('React').createElement(c('Image.react'),{src:this.props.secondaryImageUrl,className:"_1fwc"}):null,u=c('React').createElement('div',{className:r},s,this.props.showBlueIndicator&&c('React').createElement('div',{className:"_3xlk"}),n&&c('React').createElement('div',{className:"_1dbr"},c('React').createElement('div',{className:"_1464"})),this.props.loading&&c('React').createElement('div',{className:"_1dbr"},c('React').createElement(c('XUISpinner.react'),{background:p?'light':'dark',className:"_1dbs"})),o&&c('React').createElement('div',{className:"_ern"},c('React').createElement(c('Image.react'),{alt:j._("LIVE"),src:h("118398")})),t),v=c('React').createElement('div',{className:"_efz"},c('React').createElement('span',{className:"_ef_"},j._("Your Story"))),w=c('React').createElement('div',{className:"_1fw3"},this.props.actorName),x=c('IntlVariations').GENDER_UNKNOWN;if(this.props.actorGender=='MALE'){x=c('IntlVariations').GENDER_MALE}else if(this.props.actorGender=='FEMALE')x=c('IntlVariations').GENDER_FEMALE;var y=this.props.isOwnBucket?j._("Watch Your Story"):j._({"*":"Watch {actor name}'s Story"},[j.param('actor name',this.props.actorName,[1,x])]),z=this.props.isOwnBucket?v:w;return c('React').createElement('div',{role:'button',tabIndex:'0',onMouseEnter:this.$FBStoryTrayItem1,onMouseLeave:this.$FBStoryTrayItem2,onClick:this.$FBStoryTrayItem3,onKeyPress:this.$FBStoryTrayItem3,className:"_1fvw"+(this.props.disabled?' '+"_4lu8":'')},c('React').createElement(c('Tooltip.react'),{tooltip:y,alignH:'center'},u,z))};m.defaultProps={disabled:false,actorName:'',actorGender:'',highlighted:false,showBlueIndicator:false,isOwnBucket:false,isBucketLive:false,onHover:c('emptyFunction'),onHoverOut:c('emptyFunction'),loading:false};f.exports=m}),null);
__d("range",[],(function a(b,c,d,e,f,g){function h(i,j,k){k=!k?i<j?1:-1:k;var l=-1,m=Math.max(Math.ceil((j-i)/k),0),n=Array(m);while(m--){n[++l]=i;i+=k}return n}f.exports=h}),null);
__d('HorizontalScroll.react',['ix','cx','fbt','Bootloader','BootloadOnRender.react','React','Image.react','JSResource','LazyComponent.react','fbglyph','range','compactArray','emptyFunction'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m=250;k=babelHelpers.inherits(n,c('React').Component);l=k&&k.prototype;function n(o){l.constructor.call(this,o);this.defaultProps={placeholderFactory:c('emptyFunction')};this.state={scrollLeft:0,offsetWidth:0,scrollWidth:0,viewportItemsCount:0,itemCount:0};this.$HorizontalScroll3=this.$HorizontalScroll3.bind(this);this.$HorizontalScroll2=this.$HorizontalScroll2.bind(this)}n.prototype.componentDidMount=function(){var o=this.$HorizontalScroll1.offsetWidth,p=this.props.itemWidth,q=this.props.itemMarginWidth,r=0;if(p<=o)r=1+Math.floor((o-p)/(p+q));this.setState({scrollLeft:this.$HorizontalScroll1.scrollLeft,offsetWidth:o,scrollWidth:this.$HorizontalScroll1.scrollWidth,viewportItemsCount:r})};n.prototype.componentWillUpdate=function(o,p){var q=o.children?c('compactArray')(c('React').Children.toArray(o.children)):[],r=q.length;if(r!=this.state.itemCount)this.setState({itemCount:r});};n.prototype.componentDidUpdate=function(o,p){if(p.scrollLeft!==this.state.scrollLeft)if(this.$HorizontalScroll1)c('Bootloader').loadModules(["Animation"],function(q){new q(this.$HorizontalScroll1).to('scrollLeft',this.state.scrollLeft).duration(m).go()}.bind(this),'HorizontalScroll.react');};n.prototype.render=function(){var o=this.state.scrollLeft===0,p=this.state.scrollLeft>=this.state.scrollWidth-this.state.offsetWidth||this.state.itemCount<=this.state.viewportItemsCount;return c('React').createElement('div',{className:"_lmj",ref:function(q){return this.$HorizontalScroll1=q}.bind(this)},this.props.children,this.$HorizontalScroll4(),c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('XUIButton.react').__setRef('HorizontalScroll.react'),placeholder:c('React').createElement('span',null),component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the left"),className:(o?"hidden_elem":'')+(' '+"_lmk")+(' '+"_6107"),onClick:this.$HorizontalScroll2,label:'With a Hidden Label',labelIsHidden:true,image:c('React').createElement(c('Image.react'),{className:"_lml",src:h("141823")}),href:{url:'#'}})}),c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('XUIButton.react').__setRef('HorizontalScroll.react'),placeholder:c('React').createElement('span',null),component:c('React').createElement(c('LazyComponent.react'),{'aria-label':j._("See more results from the right"),className:(p?"hidden_elem":'')+(' '+"_lmm")+(' '+"_6107"),onClick:this.$HorizontalScroll3,label:'With a Hidden Label',labelIsHidden:true,image:c('React').createElement(c('Image.react'),{className:"_lml",src:h("141833")}),href:{url:'#'}})}))};n.prototype.$HorizontalScroll4=function(){var o=Math.max(0,this.state.viewportItemsCount-this.state.itemCount);return c('range')(0,o).map(this.props.placeholderFactory)};n.prototype.$HorizontalScroll2=function(){var o=Math.max(0,this.$HorizontalScroll1.scrollLeft-this.$HorizontalScroll5(false));this.setState({scrollLeft:o})};n.prototype.$HorizontalScroll3=function(){var o=Math.min(this.$HorizontalScroll6(),this.$HorizontalScroll1.scrollLeft+this.$HorizontalScroll5(true));this.setState({scrollLeft:o})};n.prototype.$HorizontalScroll5=function(o){var p=this.state.viewportItemsCount*(this.props.itemWidth+this.props.itemMarginWidth),q=this.$HorizontalScroll6(),r=o?q-(this.state.scrollLeft+p):this.state.scrollLeft-p;return r<this.props.itemWidth?q:p};n.prototype.$HorizontalScroll6=function(){return this.state.scrollWidth-this.state.offsetWidth};f.exports=n}),null);
__d('FBStoriesTray.react',['cx','React','idx','emptyFunction','CameraPostTypes','FBStoryTrayItem.react','HorizontalScroll.react','FBStoriesDataHelper'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=48,l=10;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){var n,o,p=this.props,q=p.userBucket,r=p.friendsData,s=p.userBucketHasNewViewers,t=p.userBucketHasContent,u=p.userBucketIsLive,v=!r||r.length===0;if(v&&!t)return null;var w=(n=q)!=null?(n=n.camera_post_bucket_owner)!=null?(n=n.profile_picture)!=null?n.uri:n:n:n,x=c('FBStoriesDataHelper').getPreviewImage(q),y=(o=q)!=null?o.camera_post_type:o,z=q.id,aa=[t?c('React').createElement(c('FBStoryTrayItem.react'),{highlighted:s,showBlueIndicator:s,bucketID:z,key:z,imageUrl:this.props.showAsPreviews?x:w,secondaryImageUrl:this.props.showAsPreviews?w:null,isOwnBucket:true,isBucketLive:u,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:y,loading:this.props.loadingBucketID===z}):null].concat(this.$FBStoriesTray1());return c('React').createElement(c('HorizontalScroll.react'),{itemWidth:k,itemMarginWidth:l,placeholderFactory:this.$FBStoriesTray2},aa)};m.prototype.$FBStoriesTray2=function(n){return c('React').createElement('div',{key:n,className:"_1fvw"},c('React').createElement('div',{className:"_rqg"}))};m.prototype.$FBStoriesTray1=function(){return this.props.friendsData.map(function(n,o){var p,q,r,s=n.id,t=n.camera_post_bucket_owner;if(!s||!t)return null;var u=(p=n)!=null?p.camera_post_type:p,v=t.id,w=u===c('CameraPostTypes').STORY?t.short_name:t.name;if(!v||!w)return null;var x=u===c('CameraPostTypes').EVENT_STORY,y=n.live_video&&n.live_video.id,z=(q=t)!=null?(q=q.profile_picture)!=null?q.uri:q:q,aa=void 0,ba=void 0;if(x){var ca;aa=(ca=t)!=null?(ca=ca.cover_photo)!=null?(ca=ca.photo)!=null?(ca=ca.image)!=null?ca.uri:ca:ca:ca:ca;ba=null}else if(this.props.showAsPreviews){aa=c('FBStoriesDataHelper').getPreviewImage(n);ba=z}else{aa=z;ba=null}var da=((r=n)!=null?(r=r.threads)!=null?r.nodes:r:r)||[],ea=da.filter(function(ga){return !ga.is_seen_by_viewer}).length>0,fa={bucketID:s,actorName:w,actorGender:t.gender,imageUrl:aa,secondaryImageUrl:ba,highlighted:ea,isBucketLive:y,key:v,onHover:this.props.onItemHover,onHoverOut:this.props.onItemHoverOut,onSelect:this.props.onItemSelect,cameraPostType:u,loading:this.props.loadingBucketID===s};return c('React').createElement(c('FBStoryTrayItem.react'),fa)}.bind(this))};function m(){i.apply(this,arguments)}m.defaultProps={onItemHover:c('emptyFunction'),onItemHoverOut:c('emptyFunction'),loadingBucketID:null};f.exports=m}),null);
__d('FBStoriesTrayContainer.react',['ix','cx','fbt','React','Bootloader','FBStoriesTray.react','FBStoriesStore','FluxContainer','Image.react','Tooltip.react','BootloadOnRender.react','LazyComponent.react','JSResource','idx','fbglyph','CurrentUser','range'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l,m,n;k=babelHelpers.inherits(o,c('React').PureComponent);l=k&&k.prototype;function o(s){l.constructor.call(this,s);this.$FBStoriesTrayContainer3=function(){if(!this.state.isViewerOpen)return;c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(t){t.storyLog('closeStory','closeFromClickingOnModal');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer4=function(){c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(t){t.storyLog('closeStory','closeFromClickingOnModalClose');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer5=function(){c('Bootloader').loadModules(["FBStoriesLoggingHelper"],function(t){t.storyLog('closeStory','closeFromLastStoryFinishing');this.$FBStoriesTrayContainer7()}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer2=function(t){this.setState({showItemLoader:true});c('Bootloader').loadModules(["FBStoriesActions","CameraPostWWWTypedLogger","CameraPostLoggingEvents","FBStoriesLoggingHelper"],function(u,v,w,x){new v().setCameraPostType(c('FBStoriesStore').getCameraPostTypeForBucketId(t)).setWebSurface('www').setEventType(w.BUCKET_SELECTED_FROM_TRAY).setEventDetails(t).setViewerID(c('CurrentUser').getID()).setThreadID(this.state.currentThreadID).log();u.userSelectedBucket(t);x.storyLog('openStory','openFromStoryHead');this.setState({isViewerOpen:true,showItemLoader:false})}.bind(this),'FBStoriesTrayContainer.react')}.bind(this);this.$FBStoriesTrayContainer6=function(){this.setState({isStoryMuted:!this.state.isStoryMuted})}.bind(this);this.state={friendsData:[],userBucket:{},userBucketHasNewViewers:false,userBucketHasContent:false,loading:true,currentThreadID:null,isViewerOpen:false,showItemLoader:false,isStoryMuted:false,userBucketIsLive:false,selectedBucketIsLive:false,bucketID:null,mediaIDForSelectedBucket:null}}o.getStores=function(){return [c('FBStoriesStore')]};o.calculateState=function(s){return {userBucket:c('FBStoriesStore').getUserBucketData(),userBucketHasNewViewers:c('FBStoriesStore').hasOwnBucketViewers(),userBucketHasContent:c('FBStoriesStore').hasOwnBucketContent(),friendsData:c('FBStoriesStore').getFriendsBucketData(),loading:c('FBStoriesStore').isLoading(),currentThreadID:c('FBStoriesStore').getCurrentThreadIDForSelectedBucket(),isOwnBucket:c('FBStoriesStore').isOwnBucket(),userBucketIsLive:c('FBStoriesStore').userBucketIsLive(),bucketID:c('FBStoriesStore').getSelectedBucketId(),selectedBucketIsLive:c('FBStoriesStore').isSelectedBucketLive(),mediaIDForSelectedBucket:c('FBStoriesStore').getCurrentThreadMediaIDForSelectedBucket()}};o.prototype.render=function(){if(this.state.loading)return c('React').createElement('div',{className:"_60kg"},c('React').createElement(p,null),c('React').createElement(r,null));if(this.$FBStoriesTrayContainer1())c('React').createElement('div',{className:"_60kg"});return c('React').createElement('div',{className:"_60kg"},c('React').createElement(p,null),c('React').createElement(c('FBStoriesTray.react'),{showAsPreviews:this.props.showAsPreviews,friendsData:this.state.friendsData,userBucket:this.state.userBucket,userBucketHasContent:this.state.userBucketHasContent,userBucketHasNewViewers:this.state.userBucketHasNewViewers,loading:this.state.loading,loadingBucketID:this.state.showItemLoader?this.state.bucketID:null,userBucketIsLive:this.state.userBucketIsLive,onItemSelect:this.$FBStoriesTrayContainer2}),this.state.isViewerOpen&&c('React').createElement(c('BootloadOnRender.react'),{loader:c('JSResource')('FBStoriesTheater.react').__setRef('FBStoriesTrayContainer.react'),placeholder:c('React').createElement(q,null),component:c('React').createElement(c('LazyComponent.react'),{onHide:this.$FBStoriesTrayContainer3,onClose:this.$FBStoriesTrayContainer4,onDone:this.$FBStoriesTrayContainer5,onMute:this.$FBStoriesTrayContainer6,isStoryMuted:this.state.isStoryMuted})}))};o.prototype.$FBStoriesTrayContainer1=function(){var s,t=this.state,u=t.friendsData,v=t.userBucket,w=t.loading,x=((s=v)!=null?(s=s.threads)!=null?s.nodes:s:s)||[],y=!v||x.length==0,z=!u||u.length==0,aa=y&&z;return !w&&aa};o.prototype.$FBStoriesTrayContainer7=function(){if(this.state.isOwnBucket&&this.state.currentThreadID)c('Bootloader').loadModules(["FBStoriesActions","CameraPostWWWTypedLogger","CameraPostLoggingEvents"],function(s,t,u){var v=c('FBStoriesStore').getSelectedBucketCameraPostType();new t().setCameraPostType(v).setWebSurface('www').setEventType(u.STORIES_VIEWER_CLICKOUT).setEventDetails(0).setViewerID(c('CurrentUser').getID()).setThreadID(this.state.currentThreadID).log();s.markThreadViewersSeen(this.state.currentThreadID)}.bind(this),'FBStoriesTrayContainer.react');if(this.state.selectedBucketIsLive&&this.state.mediaIDForSelectedBucket)c('Bootloader').loadModules(["FBStoriesLiveVideoActions","FBStoriesActions"],function(s,t){s.removeUIComponents(this.state.mediaIDForSelectedBucket);t.removeEndedLiveVideo()}.bind(this),'FBStoriesTrayContainer.react');this.setState({isViewerOpen:false,isStoryMuted:false})};var p=function s(){return c('React').createElement('div',{className:"_2mro"},c('React').createElement('span',{className:"_2ms2"},j._("Stories")),c('React').createElement(c('Tooltip.react'),{tooltip:j._("Stories are photos and videos that only last temporarily. When a friend shares to their story, it'll appear here.")},c('React').createElement(c('Image.react'),{className:"_2ms3",src:h("126682")})))};m=babelHelpers.inherits(q,c('React').PureComponent);n=m&&m.prototype;q.prototype.componentWillMount=function(){if(this.props.onLoad)this.props.onLoad();};q.prototype.componentWillUnmount=function(){if(this.props.onHide)this.props.onHide();};q.prototype.render=function(){return null};function q(){m.apply(this,arguments)}var r=function s(){var t=function u(v){return c('React').createElement('div',{className:"_h0-",key:v},c('React').createElement('div',{className:"_2ms4"},c('React').createElement('div',{className:"_2ms5"})),c('React').createElement('div',{className:"_2ms6"}),c('React').createElement('div',{className:"_2ms8"}))};return c('React').createElement('div',{className:"_h1i"},c('React').createElement('div',{className:"_h1m"},c('range')(0,10).map(t)))};f.exports=c('FluxContainer').create(o)}),null);