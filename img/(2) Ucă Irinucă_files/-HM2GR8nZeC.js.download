if (self.CavalryLogger) { CavalryLogger.start_js(["A3vbR"]); }

__d('ChatEmployeeAwayWarning',['MercuryIDs','MercuryParticipants','MercuryViewer'],(function a(b,c,d,e,f,g){var h={updateEmployeeAwayWarning:function i(j,k,l){c('MercuryParticipants').get(c('MercuryViewer').getID(),function(m){var n=m.employee;if(n)c('MercuryParticipants').getMulti(j.participants,function(o){var p=false,q=c('MercuryIDs').getUserIDFromThreadID(j.thread_id);if(!q)return;var r='fbid:'+q;for(var s in o)if(r==o[s].id&&o[s].is_employee_away)p=true;if(p){k()}else l();});})}};f.exports=h}),null);
__d("XNativeComponentFlowBookingRequestCountController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/pages\/platform\/native-component-flow\/booking_request_count\/",{page_id:{type:"FBID",required:true},user_id:{type:"FBID",required:true}})}),null);
__d('FantaReducersTabSheets',['AsyncRequest','Bootloader','ChatEmployeeAwayWarning','ChatPrivacyActionController','ChatTimezoneWarning','ChatUserFocusWarning','ChatUserPersonalUserWarning','ChatUserWorkUserWarning','CurrentUser','FantaGetMessageActions','FantaMessageActions','FantaTabActions','FantaTabSheetActions','FBID','ImmutableObject','mercuryBlockedParticipantsRe','MercuryConfig','MercuryIDs','MercuryParticipants','MercurySheetPolicy','MercuryThreadInfo','MercuryThreads','MercuryViewer','MessageThreadAssociatedObjectUtils','XNativeComponentFlowBookingRequestCountController','emptyFunction','ifRequired','setImmediate'],(function a(b,c,d,e,f,g){'use strict';var h=c('mercuryBlockedParticipantsRe').get(),i=c('MercuryThreads').get(),j=c('FantaTabActions').Types,k=c('FantaGetMessageActions').Types,l=c('FantaMessageActions').Types,m=c('FantaTabSheetActions').Types;function n(nb,ob){switch(ob.type){case j.CLOSE_TAB:case j.CLOSE_AND_TAB_NEXT:var pb=ob.tabID;if(!nb.mercury.tabContents.get(pb))return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{typeahead:null});return o(nb,pb);}return nb}function o(nb,ob,pb){var qb=nb.mercury.tabContents.get(ob);if(!qb)return nb;if(pb&&qb.openSheet!==pb)return nb;nb=nb.mergeIn(['mercury','tabContents',ob],{openSheet:null});if(qb.thread)nb=fb(nb,ob,qb.thread);return nb}function p(nb,ob){switch(ob.type){case j.CLOSE_ALL_TABS:for(var pb=nb.mercury.tabContents.keys(),qb=Array.isArray(pb),rb=0,pb=qb?pb:pb[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var sb;if(qb){if(rb>=pb.length)break;sb=pb[rb++]}else{rb=pb.next();if(rb.done)break;sb=rb.value}var tb=sb;nb=nb.mergeIn(['mercury','tabContents',tb],{typeahead:null});nb=o(nb,tb)}}return nb}function q(nb,ob){switch(ob.type){case k.ON_GET_THREAD_RESPONSE:case k.ON_GET_THREAD_PREVIEW_RESPONSE:var pb=ob.thread,qb=ob.tabID||pb.thread_id;nb=r(nb,pb,qb);}return nb}function r(nb,ob,pb){var qb=c('MercuryViewer').getID(),rb=ob.participants.filter(function(sb){return sb!==qb});if(rb.length<1&&!i.isNewEmptyLocalThread(pb)){nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet)}else nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatNoRecipientsTabSheet);if(ob.participants.length!==0)nb=fb(nb,pb,ob);return nb}function s(nb,ob){switch(ob.type){case k.THREADS_UPDATED:ob.threads.forEach(function(pb){nb=r(nb,new (c('ImmutableObject'))(pb),pb.thread_id)});}return nb}function t(nb,ob){switch(ob.type){case j.OPEN_TAB:case j.REPLACE_TAB:var pb=ob.tabID,qb=nb.mercury.tabContents.get(pb).thread;if(qb)nb=fb(nb,pb,qb);}return nb}function u(nb,ob,pb){if(c('MercuryThreadInfo').isMuted(pb)){return w(nb,ob,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet)}else return o(nb,ob,c('MercurySheetPolicy').sheets.ChatThreadIsMutedTabSheet);}function v(nb,ob,pb){if(h.isMessageBlocked(pb)){return w(nb,ob,c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet)}else return o(nb,ob,c('MercurySheetPolicy').sheets.ChatThreadIsMessageBlockedSheet);}function w(nb,ob,pb){var qb=nb.mercury.tabContents.get(ob),rb=nb.tabGroup.tabs.get(ob);if(!rb||!qb)return nb;var sb=qb.openSheet;if(sb&&!c('MercurySheetPolicy').canReplaceOpenSheet(sb,pb))return nb;nb=nb.mergeIn(['mercury','tabContents',ob],{openSheet:pb});return nb}function x(nb,ob){return nb}function y(nb,ob){switch(ob.type){case m.OPEN_APPOINTMENT_SHEET:var pb=ob.tabID;return w(nb,pb,c('MercurySheetPolicy').sheets.ChatAppointmentBanner);}return nb}function z(nb,ob){switch(ob.type){case m.OPEN_USER_FOCUS_SHEET:var pb=ob.tabID;return w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserFocusSheet);}return nb}function aa(nb,ob){switch(ob.type){case m.CLOSE_USER_FOCUS_AND_BYPASS_SHEET:var pb=ob.tabID;nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserFocusSheet);nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserFocusBypassSheet);}return nb}function ba(nb,ob,pb){c('ChatUserFocusWarning').updateUserFocusWarning(pb,function(qb){qb?c('setImmediate')(function(){c('FantaTabSheetActions').openBypassFocusSheet(ob)}):c('setImmediate')(function(){c('FantaTabSheetActions').openUserFocusSheet(ob)})},function(){c('setImmediate')(function(){c('FantaTabSheetActions').closeUserFocusAndBypassSheet(ob)})});return nb}function ca(nb,ob){switch(ob.type){case m.OPEN_BYPASS_FOCUS_SHEET:var pb=ob.tabID;return w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserFocusBypassSheet);}return nb}function da(nb,ob){switch(ob.type){case m.OPEN_USER_TIMEZONE_SHEET:var pb=ob.tabID,qb=ob.timezoneInfo;if(!nb.mercury.tabContents.get(pb))return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{timezoneInfo:qb});return w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserTimezoneSheet);}return nb}function ea(nb,ob){switch(ob.type){case m.CLOSE_USER_TIMEZONE_SHEET:var pb=ob.tabID;if(!nb.mercury.tabContents.get(pb))return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{timezoneInfo:null});nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserTimezoneSheet);}return nb}function fa(nb,ob,pb){c('ChatTimezoneWarning').updateUserTimezoneWarning(pb,function(qb){c('setImmediate')(function(){c('FantaTabSheetActions').openUserTimezoneSheet(ob,qb)})},function(){c('setImmediate')(function(){c('FantaTabSheetActions').closeUserTimezoneSheet(ob)})});return nb}function ga(nb,ob,pb){c('ChatEmployeeAwayWarning').updateEmployeeAwayWarning(pb,function(){return c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeeAwaySheet(ob)})},c('emptyFunction'));return nb}function ha(nb,ob){switch(ob.type){case m.OPEN_EMPLOYEE_AWAY_SHEET:var pb=ob.tabID;nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatEmployeeAwaySheet);}return nb}function ia(nb,ob,pb){c('ChatUserPersonalUserWarning').updateEmployeePersonalUserWarning(pb,function(qb,rb){c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeePersonalUserSheet(ob)})},c('emptyFunction'));return nb}function ja(nb,ob){switch(ob.type){case m.OPEN_EMPLOYEE_PERSONAL_USER_SHEET:var pb=ob.tabID;nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserIsPersonalUserSheet);}return nb}function ka(nb,ob){switch(ob.type){case m.CLOSE_EMPLOYEE_PERSONAL_USER_SHEET:var pb=ob.tabID;nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserIsPersonalUserSheet);}return nb}function la(nb,ob){switch(ob.type){case m.OPEN_EMPLOYEE_WORK_USER_SHEET:var pb=ob.tabID;nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserIsWorkUserSheet);}return nb}function ma(nb,ob){switch(ob.type){case m.CLOSE_EMPLOYEE_WORK_USER_SHEET:var pb=ob.tabID;nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserIsWorkUserSheet);}return nb}function na(nb,ob,pb){c('ChatUserWorkUserWarning').updateEmployeeWorkUserWarning(pb,function(qb,rb){c('setImmediate')(function(){c('FantaTabSheetActions').openEmployeeWorkUserSheet(ob)})},c('emptyFunction'));return nb}function oa(nb,ob){switch(ob.type){case m.OPEN_NAME_CONVERSATION_TAB_SHEET:return w(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return nb}function pa(nb,ob){switch(ob.type){case m.CLOSE_NAME_CONVERSATION_TAB_SHEET:return o(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatNameConversationTabSheet);}return nb}function qa(nb,ob){return nb}function ra(nb,ob){switch(ob.type){case m.OPEN_READ_ONLY_PERMANENT_SHEET:return w(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return nb}function sa(nb,ob){switch(ob.type){case m.CLOSE_READ_ONLY_PERMANENT_SHEET:return o(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyPermanentTabSheet);}return nb}function ta(nb,ob){switch(ob.type){case m.OPEN_READ_ONLY_SHEET:return w(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return nb}function ua(nb,ob){switch(ob.type){case m.CLOSE_READ_ONLY_SHEET:return o(nb,ob.tabID,c('MercurySheetPolicy').sheets.ChatReadOnlyTabSheet);}return nb}function va(nb,ob){return nb}function wa(nb,ob){return nb}function xa(nb,ob){return nb}function ya(nb,ob){switch(ob.type){case m.CLOSE_ADD_FRIENDS_SHEET:var pb=ob.tabID;if(!nb.mercury.tabContents.get(pb))return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{typeahead:null});return o(nb,pb,c('MercurySheetPolicy').sheets.FantaAddFriendsSheet);}return nb}function za(nb,ob){switch(ob.type){case m.CLOSE_ADD_MORE_FRIENDS_SHEET:var pb=ob.tabID;if(!nb.mercury.tabContents.get(pb))return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{typeahead:null});return o(nb,pb,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet);}return nb}function ab(nb,ob){switch(ob.type){case l.SEND_GROUP_MESSAGE:var pb=ob.tabID||ob.threadID;return o(nb,pb,c('MercurySheetPolicy').sheets.FantaAddMoreFriendsSheet);}return nb}function bb(nb,ob){switch(ob.type){case l.RECEIVED_NEW_MESSAGE:var pb=ob.tabID,qb=nb.mercury.tabContents.get(pb);if(qb&&!qb.isScrolledToBottom){nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet)}else nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);}return nb}function cb(nb,ob){switch(ob.type){case j.SCROLL_BOTTOM_CHANGED:var pb=ob.tabID,qb=ob.isScrolledToBottom;if(qb)nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatNewMessagesTabSheet);var rb=nb.mercury.tabContents.get(pb);if(rb&&rb.thread)nb=hb(nb,pb,rb.thread);}return nb}function db(nb,ob){switch(ob.type){case k.ON_PRIVACY_STATE_CHANGE:var pb=ob.threadID,qb=ob.privacyState;switch(qb){case c('ChatPrivacyActionController').OFFLINE:nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);break;case c('ChatPrivacyActionController').NORMAL:nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet);nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);break;case c('ChatPrivacyActionController').BLOCKED:nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatOfflineTabSheet);var rb=c('MercuryIDs').getUserIDFromThreadID(pb);if(rb){var sb=c('MercuryParticipants').getNow(c('MercuryIDs').getParticipantIDFromUserID(rb));sb&&sb.is_friend?(nb=w(nb,pb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet)):(nb=o(nb,pb,c('MercurySheetPolicy').sheets.ChatUserBlockedTabSheet))}break;}}return nb}function eb(nb,ob){switch(ob.type){case m.ON_IS_PAGE_TAB:var pb=ob.tabID,qb=ob.pageIndicator,rb=nb.mercury.tabContents.get(pb);if(!rb)return nb;nb=nb.mergeIn(['mercury','tabContents',pb],{pageIndicator:qb});}return nb}function fb(nb,ob,pb){nb=ba(nb,ob,pb);nb=fa(nb,ob,pb);nb=v(nb,ob,pb);nb=u(nb,ob,pb);nb=ga(nb,ob,pb);nb=ia(nb,ob,pb);nb=na(nb,ob,pb);nb=ib(nb,ob,pb);nb=lb(nb,ob,pb);nb=hb(nb,ob,pb);nb=gb(nb,ob,pb);nb=mb(nb,ob,pb);return nb}function gb(nb,ob,pb){var qb=pb.rtc_call_data,rb=pb.thread_fbid,sb=qb&&qb.call_state!=='NO_ONGOING_CALL'&&rb;if(sb){nb=w(nb,ob,c('MercurySheetPolicy').sheets.ChatJoinCallSheet)}else nb=o(nb,ob,c('MercurySheetPolicy').sheets.ChatJoinCallSheet);return nb}function hb(nb,ob,pb){var qb=pb.has_montage&&c('MercuryConfig').MontageThreadViewer,rb=nb.mercury.tabContents.get(ob),sb=!!(rb&&rb.isScrolledToBottom);if(sb&&qb){nb=w(nb,ob,c('MercurySheetPolicy').sheets.ChatMontageSheet)}else nb=o(nb,ob,c('MercurySheetPolicy').sheets.ChatMontageSheet);return nb}function ib(nb,ob,pb){c('ifRequired')('EventReminderActions',function(qb){var event=pb.lightweight_event;if(event){qb.updateEventReminder(ob,event);nb=w(nb,ob,c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet)}else c('ifRequired')('EventReminderStateStore',function(rb){var sb=rb.getEvent(ob);if(sb&&sb.exists)qb.deleteEventReminder(ob);nb=o(nb,ob,c('MercurySheetPolicy').sheets.ChatEventReminderTabSheet)},function(){return jb(ob)});},function(){return jb(ob)});return nb}function jb(nb){c('Bootloader').loadModules(["EventReminderActions","EventReminderStateStore"],function(ob,pb){c('setImmediate')(function(){c('FantaTabSheetActions').onBootloadEventReminder(nb)})},'FantaReducersTabSheets')}function kb(nb,ob){switch(ob.type){case m.ON_BOOTLOAD_EVENT_REMINDER:var pb=ob.tabID,qb=nb.mercury.tabContents.get(pb);if(!qb)return nb;var rb=qb.thread;if(rb)nb=ib(nb,pb,rb);}return nb}function lb(nb,ob,pb){var qb=pb.other_user_fbid;if(qb&&!c('FBID').isUser(qb)&&c('MercuryConfig').ShowAppointmentBanner){var rb=c('XNativeComponentFlowBookingRequestCountController').getURIBuilder().setFBID('page_id',qb).setFBID('user_id',c('CurrentUser').getID()).getURI();new (c('AsyncRequest'))().setURI(rb).setHandler(function(sb){var tb=sb&&sb.getPayload();if(tb&&tb.confirmed+tb.pending>0)c('FantaTabSheetActions').openAppointmentBannerSheet(ob);}).send()}else nb=o(nb,ob,c('MercurySheetPolicy').sheets.ChatAppointmentBanner);return nb}function mb(nb,ob,pb){var qb=pb.associated_object;if(c('MessageThreadAssociatedObjectUtils').shouldRender(qb))nb=w(nb,ob,c('MercurySheetPolicy').sheets.ChatRoomAssociatedObjectSheet);return nb}f.exports={closeAddFriends:ya,closeAddMoreFriends:za,closeAllTabs:p,closeEmployeePersonalUserSheet:ka,closeEmployeeWorkUserSheet:ma,closeFocusUserSheet:aa,closeNameConversationSheet:pa,closePermanentReadOnlySheet:sa,closeReadOnlySheet:ua,closeTab:n,closeUserTimezoneSheet:ea,onBootloadEventReminder:kb,onGetThreadResponse:q,onIsPageTab:eb,onPrivacyStateChange:db,openAddFriendsSheet:x,openAppointmentBannerSheet:y,openBypassFocusSheet:ca,openEmployeeAwaySheet:ha,openEmployeePersonalUserSheet:ja,openEmployeeWorkUserSheet:la,openFocusUserSheet:z,openNameConversationSheet:oa,openNewMessagesSheet:qa,openPermanentReadOnlySheet:ra,openReadOnlySheet:ta,openTab:t,openUploadWarningTabSheet:va,openUserFocusSheet:wa,openUserIsPersonalUserSheet:xa,openUserTimezoneSheet:da,receivedNewMessage:bb,scrollBottomChanged:cb,sendGroupMessage:ab,threadsUpdated:s}}),null);